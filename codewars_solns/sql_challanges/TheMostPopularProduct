--https://www.codewars.com/kata/649d368a27e215c473e220ba
WITH CTE AS
	(SELECT PRODUCTS.ID AS PRODUCT_ID,
			PRODUCTS.PRODUCT_NAME,
			COUNT(ORDERS.PRODUCT_ID) AS COUNT_ORDERS,
			RANK() OVER(
															ORDER BY COUNT(ORDERS.PRODUCT_ID) DESC) AS RNK
		FROM EXERCISE2.ORDERS,
			EXERCISE2.PRODUCTS,
			EXERCISE2.USERS
		WHERE ORDERS.USER_ID = USERS.ID
			AND ORDERS.PRODUCT_ID = PRODUCTS.ID
		GROUP BY PRODUCTS.ID
		ORDER BY PRODUCTS.ID DESC)
SELECT PRODUCT_ID,
	PRODUCT_NAME,
	COUNT_ORDERS
FROM CTE
WHERE RNK = 1;